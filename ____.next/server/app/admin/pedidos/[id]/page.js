(()=>{var e={};e.id=246,e.ids=[246],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},72254:e=>{"use strict";e.exports=require("node:buffer")},6005:e=>{"use strict";e.exports=require("node:crypto")},15673:e=>{"use strict";e.exports=require("node:events")},88849:e=>{"use strict";e.exports=require("node:http")},22286:e=>{"use strict";e.exports=require("node:https")},47261:e=>{"use strict";e.exports=require("node:util")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},15594:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>n});var s=r(67096),i=r(16132),a=r(37284),o=r.n(a),l=r(32564),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);r.d(t,d);let n=["",{children:["admin",{children:["pedidos",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,47564)),"/Users/altice/RomApps/items-control/src/app/admin/pedidos/[id]/page.tsx"]}]},{}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,9414)),"/Users/altice/RomApps/items-control/src/app/layout.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,68056)),"/Users/altice/RomApps/items-control/src/app/loading.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9291,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Users/altice/RomApps/items-control/src/app/admin/pedidos/[id]/page.tsx"],u="/admin/pedidos/[id]/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/admin/pedidos/[id]/page",pathname:"/admin/pedidos/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:n}})},65700:(e,t,r)=>{Promise.resolve().then(r.bind(r,58037)),Promise.resolve().then(r.bind(r,46179))},70346:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(43058),i=r(53854);let a=(0,s.Z)((0,i.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5-1-1h-5l-1 1H5v2h14V4z"}),"DeleteOutline")},83285:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(43058),i=r(53854);let a=(0,s.Z)((0,i.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm2 16H5V5h11.17L19 7.83V19zm-7-7c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3zM6 6h9v4H6z"}),"SaveOutlined")},663:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(83847);let i=s.Z.create({baseURL:"http://localhost:3000/api"}),a=i},46179:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>P});var s=r(53854),i=r(34218),a=r(43058);let o=(0,a.Z)((0,s.jsx)("path",{d:"M7 11v2h10v-2H7zm5-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"RemoveCircleOutlineOutlined"),l=(0,a.Z)((0,s.jsx)("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h10v-2H4v-6h18V6c0-1.11-.89-2-2-2zm0 4H4V6h16v2zm4 9v2h-3v3h-2v-3h-3v-2h3v-3h2v3h3z"}),"AddCardOutlined");var d=r(70346),n=r(83285);let c=(0,a.Z)((0,s.jsx)("path",{d:"M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67 2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2v9.67z"}),"SaveAltOutlined");var u=r(43958),p=r(21703),m=r(91494),x=r(91437),h=r(38770),f=r(62690),v=r(93072),y=r(92747),g=r(30505),j=r(90509),b=r(51018),Z=r(27470),q=r(663);function P({order:e}){let{register:t,handleSubmit:r,formState:{errors:a},getValues:P,setValue:w,watch:C}=(0,y.cI)({defaultValues:e}),[S,_]=(0,i.useState)(void 0),[E,N]=(0,i.useState)(void 0),[z,I]=(0,i.useState)(e.orderItems),[O,A]=(0,i.useState)({product:"",title:"",quantity:0}),[T,V]=(0,i.useState)(!1),[D,H]=(0,i.useState)(!1),[M,R]=(0,i.useState)(!1),U=(0,b.useRouter)(),k=[{field:"productName",headerName:"Producto",width:300},{field:"quantity",headerName:"Cantidad",width:80},{field:"product",headerName:"Eliminar",width:100,align:"center",headerAlign:"center",renderCell:({row:e})=>s.jsx(g.Z,{color:"error",startIcon:s.jsx(o,{}),disabled:"Completado"==P("status"),onClick:()=>$(e),sx:{ml:1,width:"20px",justifyItems:"center"}})}];(0,i.useEffect)(()=>{let e=async()=>{let{data:e}=await (0,q.Z)("/products");_(e)};e()},[]),(0,i.useEffect)(()=>{S&&H(!0)},[S]),(0,i.useEffect)(()=>{let e=async()=>{let{data:e}=await (0,q.Z)("/customers");N(e)};e()},[]),(0,i.useEffect)(()=>{E&&R(!0)},[E]);let G=async e=>{V(!0);try{e.orderItems=z,e.status="En proceso";let t=await (0,q.Z)("/orders",{method:e._id?"PUT":"POST",data:JSON.stringify(e)});if(V(!1),"OK"!==t.statusText)throw Error(t.statusText);alert("Pedido guardado correctamente."),U.replace(`/admin/pedidos/${t.data._id}`)}catch(e){V(!1),alert("Ha ocurrido un error. "+e),console.log(e)}},L=async e=>{V(!0);try{e.orderItems=z,e.status="Completado";let t=await (0,q.Z)("/orders",{method:"PUT",data:JSON.stringify(e)});if(V(!1),"OK"!==t.statusText)throw Error(t.statusText);alert("Pedido procesado correctamente."),U.replace("/pedidos"),U.refresh()}catch(e){V(!1),alert("Ha ocurrido un error. "+e),console.log(e)}},K=async e=>{try{let t=await (0,q.Z)("/orders",{method:"DELETE",data:JSON.stringify(e)});if("OK"!==t.statusText&&"OK"!==t.statusText)throw Error(t.statusText);alert("Pedido eliminado correctamente. Nota: esto no afecta la existencia"),U.replace("/pedidos"),U.refresh()}catch(e){V(!1),console.log(e)}},W=async()=>{if(""==O.product||O.quantity<1){alert("Debe especificar el producto y la cantidad correcta");return}let e=S.filter(e=>e._id==O.product);I([...z,{id:e[0]._id+new Date,product:e[0]._id,productName:e[0].title,productSlug:e[0].slug,productImage:e[0].images[0],quantity:O.quantity,status:"En proceso"}]),A({product:"",title:"",quantity:0})},F=e=>{let t=S.filter(t=>t._id==e.target.value);A({...O,product:t[0]._id,title:t[0].title})},J=e=>{let t=E.filter(t=>t._id==e);w("customer",t[0]._id,{shouldValidate:!0}),w("customerName",t[0].firstName+" "+t[0].lastName,{shouldValidate:!0}),w("customerEmail",t[0].email,{shouldValidate:!0}),w("customerPhone",t[0].phone,{shouldValidate:!0})},$=e=>{let t=z.filter(t=>t.id!=e.id);I(t)},B=z.map(e=>({id:e.id,productName:e.productName,product:e.product,productSlug:e.productSlug,quantity:e.quantity,status:e.status}));return D?M?s.jsx(j.Z,{sx:{display:"flex",flexDirection:"column"},children:s.jsx("form",{name:"entryForm",onSubmit:r(G),children:s.jsx(p.ZP,{container:!0,spacing:2,mt:1,children:(0,s.jsxs)(p.ZP,{item:!0,xs:12,children:[(0,s.jsxs)(j.Z,{sx:{display:"flex",flexDirection:"column",mb:1},children:[(0,s.jsxs)(j.Z,{sx:{display:"flex",flexDirection:"column",mb:1},children:[s.jsx(m.Z,{select:!0,id:"customer",defaultValue:e.customer,label:"Cliente",disabled:"Completado"==P("status"),...t("customer",{required:"Este campo es requerido"}),error:!!a.customer,helperText:"Seleccione el cliente de este pedido",onChange:e=>J(e.target.value),sx:{ml:1,mb:2},children:E.map(e=>s.jsx(x.Z,{value:e._id,sx:{display:"flex",flexDirection:"row"},children:e.firstName+" "+e.lastName},e._id))}),s.jsx(m.Z,{label:"Correo",variant:"outlined",autoComplete:"false",id:"email",value:P("customerEmail"),name:"email",sx:{ml:1,mb:1},...t("customerEmail")})]}),(0,s.jsxs)(j.Z,{sx:{display:"flex",flexDirection:"row",mb:1},children:[s.jsx(m.Z,{label:"Telefono",variant:"outlined",autoComplete:"false",id:"phone",fullWidth:!0,value:P("customerPhone"),name:"phone",sx:{mb:1,ml:1},...t("customerPhone")}),s.jsx(m.Z,{label:"Estado",variant:"outlined",autoComplete:"false",id:"status",name:"status",value:P("status"),sx:{mb:1,ml:2},...t("status",{}),error:!!a.status})]})]}),(0,s.jsxs)(j.Z,{sx:{display:"flex",flexDirection:"column",boxShadow:2,border:1,borderRadius:2,borderColor:"teal",ml:1},children:[s.jsx(u.Z,{sx:{m:1},color:"secondary",children:"Agregar productos"}),s.jsx(h.Z,{}),(0,s.jsxs)(j.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-evenly"},children:[s.jsx(m.Z,{select:!0,disabled:"Completado"==P("status"),id:"Producto",fullWidth:!0,value:O.product,name:"product",SelectProps:{renderValue:e=>O.title},helperText:"Seleccione el producto a agregar",onChange:e=>F(e),sx:{m:1},children:S.map(e=>(0,s.jsxs)(x.Z,{value:e._id,sx:{display:"flex",flexDirection:"row",flex:"wrap"},children:[s.jsx(j.Z,{sx:{width:"20px",mr:1},children:s.jsx(f.Z,{component:"img",image:e.images[0],alt:e.title})}),e.title," - ",e.inStock]},e._id))}),s.jsx(m.Z,{label:"Cantidad",variant:"outlined",disabled:"Completado"==P("status"),type:"number",value:O.quantity,onChange:e=>A({...O,quantity:Number(e.target.value)}),autoComplete:"false",id:"quantity",name:"quantity",InputProps:{inputProps:{min:0,max:99}},sx:{m:1,width:"110px"}})]}),s.jsx(j.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:s.jsx(g.Z,{color:"secondary",startIcon:s.jsx(l,{}),disabled:"Completado"==P("status"),sx:{m:1,width:"150px",height:"30px"},onClick:()=>W(),children:"Agregar"})})]}),s.jsx(v.Z,{sx:{m:1}}),s.jsx(p.ZP,{container:!0,className:"fadeIn",children:s.jsx(p.ZP,{item:!0,lg:12,xs:12,sx:{height:300,width:"100%"},children:s.jsx(Z._$,{sx:{boxShadow:2,border:1,borderColor:"teal",color:"secondary.main","& .MuiDataGrid-cell:hover":{color:"primary.main"},ml:1},rows:B,columns:k,autoPageSize:!0})})}),s.jsx(v.Z,{sx:{m:1}}),(0,s.jsxs)(j.Z,{display:"flex",flexDirection:"row",justifyContent:"space-between",sx:{m:1},children:[s.jsx(g.Z,{color:"error",startIcon:s.jsx(d.Z,{}),sx:{width:"100px",height:"30px",ml:1,mt:1},type:"button",onClick:()=>K(P("_id")),children:"Eliminar"}),s.jsx(g.Z,{color:"secondary",startIcon:s.jsx(n.Z,{}),sx:{width:"100px",height:"30px",m:1},type:"submit",disabled:T||"Completado"==P("status"),children:"Guardar"}),s.jsx(g.Z,{color:"primary",startIcon:s.jsx(c,{}),sx:{width:"160px",height:"30px",mt:1},onClick:()=>L(e),disabled:T||"En proceso"!==P("status"),children:"Procesar pedido"})]})]})})})}):s.jsx(u.Z,{marginInlineStart:"5px",fontWeight:"bold",color:"secondary",children:"Cargando clientes..."}):s.jsx(u.Z,{marginInlineStart:"5px",fontWeight:"bold",color:"secondary",children:"Cargando productos..."})}},47564:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var s=r(4656),i=r(17718),a=r(95153);let o=(0,a.createProxy)(String.raw`/Users/altice/RomApps/items-control/src/components/OrdersForm.tsx`),{__esModule:l,$$typeof:d}=o,n=o.default;var c=r(78948);async function u({orderId:e}){let t;let{data:r,statusText:i}=await (0,c.Z)(`/orders/${"nuevo"===e?"":e}`);if("nuevo"!==e){if(!r&&"OK"!==i)return s.jsx(s.Fragment,{children:i});t=r}else t={_id:"",customer:"",customerName:"",customerEmail:"",customerPhone:"",status:"Nuevo",orderItems:[],createdAt:"",updatedAt:""};return s.jsx(n,{order:t})}function p({params:e}){return(0,s.jsxs)(i.Box,{sx:{display:"flex",flexDirection:"column"},children:[s.jsx(i.Box,{display:"flex",marginInlineStart:"5px",justifyContent:"space-between",children:(0,s.jsxs)(i.Typography,{color:"secondary",children:["Pedido: ",e.id]})}),s.jsx(u,{orderId:e.id})]})}},78948:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(40700);let i=s.Z.create({baseURL:"http://localhost:3000/api"}),a=i},73881:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(31323);let i=e=>{let t=(0,s.fillMetadataSegment)(".",e.params,"favicon.ico");return[{type:"image/x-icon",sizes:"16x16",url:t+""}]}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[271,697,700,323,760,79,15],()=>r(15594));module.exports=s})();