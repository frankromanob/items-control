(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[619],{91122:function(e,t,a){"use strict";var r=a(38173),s=a(57437);t.Z=(0,r.Z)((0,s.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5-1-1h-5l-1 1H5v2h14V4z"}),"DeleteOutline")},76712:function(e,t,a){"use strict";var r=a(38173),s=a(57437);t.Z=(0,r.Z)((0,s.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm2 16H5V5h11.17L19 7.83V19zm-7-7c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3zM6 6h9v4H6z"}),"SaveOutlined")},9475:function(e,t,a){Promise.resolve().then(a.bind(a,29899)),Promise.resolve().then(a.bind(a,16912))},86447:function(e,t,a){"use strict";var r=a(92173);let s=r.Z.create({baseURL:"".concat("http://localhost:3000","/api")});t.Z=s},16912:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return j}});var r=a(57437),s=a(2265),i=a(91122),l=a(76712),o=a(85269),n=a(38939),d=a(65984),c=a(76182),u=a(67248),h=a(64494),m=a(54986),x=a(61865),p=a(96507),f=a(49600),g=a(24033),Z=a(86447);function j(e){var t,a;let{entry:j}=e,{register:v,handleSubmit:y,formState:{errors:b},getValues:w,setValue:E,watch:C}=(0,x.cI)({defaultValues:j}),[S,V]=(0,s.useState)(void 0),[_,N]=(0,s.useState)(!1),[T,q]=(0,s.useState)(!1),O=(0,g.useRouter)();(0,s.useEffect)(()=>{let e=async()=>{let{data:e}=await (0,Z.Z)("/products");V(e)};e()},[]),(0,s.useEffect)(()=>{S&&q(!0)},[S]);let P=async e=>{N(!0);try{console.log(e);let t=await (0,Z.Z)({method:e._id?"PUT":"POST",url:"/entries",data:JSON.stringify(e),headers:{"Content-Type":"multipart/form-data; "}});if(N(!1),"OK"!==t.statusText)throw Error(t.statusText);alert("Entrada guardada correctamente."),O.replace("/entradas"),O.refresh()}catch(e){N(!1),alert("Ha ocurrido un error. "+e),console.log(e)}},I=async e=>{try{let t=await (0,Z.Z)("/entries",{method:"DELETE",data:JSON.stringify(e)});if("OK"!==t.statusText)throw Error(t.statusText);alert("Entrada eliminada correctamente. Nota: esto no rebaja la existencia"),O.replace("/entradas"),O.refresh()}catch(e){N(!1),console.log(e)}},z=e=>{let t=S.filter(t=>t._id==e);E("productName",t[0].title,{shouldValidate:!0}),E("productSlug",t[0].slug,{shouldValidate:!0}),E("productImage",t[0].images[0],{shouldValidate:!0})};return T?(0,r.jsx)(p.Z,{sx:{display:"flex",flexDirection:"column",m:1},children:(0,r.jsx)("form",{name:"entryForm",onSubmit:y(P),children:(0,r.jsx)(n.ZP,{container:!0,spacing:2,mt:1,children:(0,r.jsxs)(n.ZP,{item:!0,xs:12,children:[(0,r.jsx)(n.ZP,{item:!0,xs:6,sm:3,mb:2,children:(0,r.jsx)(d.Z,{sx:{width:"110px"},children:(0,r.jsx)(c.Z,{component:"img",className:"fadeIn",width:"200",height:"100%",image:"".concat(w("productImage")),alt:w("productName")})})},w("product")),(0,r.jsx)(p.Z,{sx:{display:"flex",flexDirection:"row",width:"50",height:"30",mb:1},children:(0,r.jsx)(u.Z,{select:!0,fullWidth:!0,id:"Producto",disabled:"Completada"==w("status"),defaultValue:j.product,label:"Producto",...v("product",{required:"Este campo es requerido"}),error:!!b.product,helperText:null===(t=b.product)||void 0===t?void 0:t.message,onChange:e=>z(e.target.value),children:S.map(e=>(0,r.jsxs)(h.Z,{value:e._id,sx:{display:"flex",flexDirection:"row"},children:[(0,r.jsx)(p.Z,{sx:{width:"20px",mr:1},children:(0,r.jsx)(c.Z,{component:"img",image:e.images[0],alt:e.title})}),e.title]},e._id))})}),(0,r.jsx)(u.Z,{label:"Cantidad",variant:"outlined",fullWidth:!0,type:"number",disabled:"Completada"==w("status"),autoComplete:"false",id:"quantity",name:"quantity",sx:{mb:1},...v("quantity",{required:"Este campo es requerido",validate:e=>e<1?"No puede ser menor a 1":void 0}),error:!!b.quantity,helperText:null===(a=b.quantity)||void 0===a?void 0:a.message}),(0,r.jsx)(u.Z,{label:"Estado",variant:"outlined",fullWidth:!0,autoComplete:"false",id:"status",name:"status",value:w("status"),sx:{mb:1},...v("status",{}),error:!!b.status}),(0,r.jsx)(m.Z,{sx:{my:1}}),(0,r.jsxs)(p.Z,{display:"flex",flexDirection:"row",justifyContent:"space-between",sx:{mb:1},children:[(0,r.jsx)(f.Z,{color:"error",startIcon:(0,r.jsx)(i.Z,{}),sx:{width:"100px",height:"30px",marginInlineEnd:"20px"},type:"button",onClick:()=>I(w("_id")),children:"Eliminar"}),(0,r.jsx)(f.Z,{color:"secondary",startIcon:(0,r.jsx)(l.Z,{}),sx:{width:"150px",height:"30px"},type:"submit",disabled:_||"Completada"==w("status"),children:"Guardar"})]})]})})})}):(0,r.jsx)(o.Z,{marginInlineStart:"5px",fontWeight:"bold",color:"secondary",children:"Cargando productos..."})}}},function(e){e.O(0,[869,899,604,971,472,744],function(){return e(e.s=9475)}),_N_E=e.O()}]);